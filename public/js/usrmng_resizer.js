!function(e){"use strict";function n(e,n,i){"addEventListener"in window?e.addEventListener(n,i,!1):"attachEvent"in window&&e.attachEvent("on"+n,i)}function i(e,n,i){"removeEventListener"in window?e.removeEventListener(n,i,!1):"detachEvent"in window&&e.detachEvent("on"+n,i)}function t(e){return O+"["+(i="Host page: "+(n=e),window.top!==window.self&&(i=window.parentIFrame&&window.parentIFrame.getId?window.parentIFrame.getId()+": "+n:"Nested host page: "+n),i)+"]";var n,i}function o(e){return S[e]?S[e].log:R}function r(e,n){d("log",e,n,o(e))}function a(e,n){d("info",e,n,o(e))}function s(e,n){d("warn",e,n,!0)}function d(e,n,i,o){!0===o&&"object"==typeof window.console&&console[e](t(n),i)}function c(e){function t(){o("Height"),o("Width"),p(function(){h(P),m(H),I("resizedCallback",P)},P,"init")}function o(e){var n=Number(S[H]["max"+e]),i=Number(S[H]["min"+e]),t=e.toLowerCase(),o=Number(P[t]);r(H,"Checking "+t+" is in range "+i+"-"+n),i>o&&(o=i,r(H,"Set "+t+" to min value")),o>n&&(o=n,r(H,"Set "+t+" to max value")),P[t]=""+o}function d(e){return W.substr(W.indexOf(":")+E+e)}function c(e,n){var i,t,o;i=function(){var i,t;b("Send Page Info","pageInfo:"+(i=document.body.getBoundingClientRect(),t=P.iframe.getBoundingClientRect(),JSON.stringify({iframeHeight:t.height,iframeWidth:t.width,clientHeight:Math.max(document.documentElement.clientHeight,window.innerHeight||0),clientWidth:Math.max(document.documentElement.clientWidth,window.innerWidth||0),offsetTop:parseInt(t.top-i.top,10),offsetLeft:parseInt(t.left-i.left,10),scrollTop:window.pageYOffset,scrollLeft:window.pageXOffset})),e,n)},t=32,j[o=n]||(j[o]=setTimeout(function(){j[o]=null,i()},t))}function v(e){var n=e.getBoundingClientRect();return f(H),{x:Math.floor(Number(n.left)+Number(N.x)),y:Math.floor(Number(n.top)+Number(N.y))}}function k(e){var n=e?v(P.iframe):{x:0,y:0},i={x:Number(P.width)+n.x,y:Number(P.height)+n.y};r(H,"Reposition requested from iFrame (offset x:"+n.x+" y:"+n.y+")"),window.top!==window.self?window.parentIFrame?window.parentIFrame["scrollTo"+(e?"Offset":"")](i.x,i.y):s(H,"Unable to scroll to requested position, window.parentIFrame not found"):(N=i,F(),r(H,"--"))}function F(){!1!==I("scrollCallback",N)?m(H):g()}function I(e,n){return l(H,e,n)}var x,M,z,R,C,W=e.data,P={},H=null;"[iFrameResizerChild]Ready"===W?function(){for(var e in S)b("iFrame requested init",y(e),document.getElementById(e),e)}():O===(""+W).substr(0,T)&&W.substr(T).split(":")[0]in S?(C=W.substr(T).split(":"),P={iframe:S[C[0]]&&S[C[0]].iframe,id:C[0],height:C[1],width:C[2],type:C[3]},H=P.id,S[H]&&(S[H].loaded=!0),(R=P.type in{true:1,false:1,undefined:1})&&r(H,"Ignoring init message from meta parent page"),!R&&(z=!0,S[M=H]||(z=!1,s(P.type+" No settings for "+M+". Message was: "+W)),z)&&(r(H,"Received: "+W),x=!0,null===P.iframe&&(s(H,"IFrame ("+P.id+") not found"),x=!1),x&&function(){var n,i=e.origin,t=S[H]&&S[H].checkOrigin;if(t&&""+i!="null"&&!(t.constructor===Array?function(){var e=0,n=!1;for(r(H,"Checking connection is from allowed list of origins: "+t);e<t.length;e++)if(t[e]===i){n=!0;break}return n}():(n=S[H]&&S[H].remoteHost,r(H,"Checking connection is from: "+n),i===n)))throw new Error("Unexpected message received from: "+i+" for "+P.iframe.id+". Message was: "+e.data+". This error can be disabled by setting the checkOrigin: false option or by providing of array of trusted domains.");return!0}()&&function(){switch(S[H]&&S[H].firstRun&&S[H]&&(S[H].firstRun=!1),P.type){case"close":S[H].closeRequestCallback?l(H,"closeRequestCallback",S[H].iframe):u(P.iframe);break;case"message":m=d(6),r(H,"MessageCallback passed: {iframe: "+P.iframe.id+", message: "+m+"}"),I("messageCallback",{iframe:P.iframe,message:JSON.parse(m)}),r(H,"--");break;case"scrollTo":k(!1);break;case"scrollToOffset":k(!0);break;case"pageInfo":c(S[H]&&S[H].iframe,H),function(){function e(e,n){function i(){S[o]?c(S[o].iframe,o):t()}["scroll","resize"].forEach(function(t){r(o,e+t+" listener for sendPageInfo"),n(window,t,i)})}function t(){e("Remove ",i)}var o=H;e("Add ",n),S[o]&&(S[o].stopPageInfo=t)}();break;case"pageInfoStop":S[H]&&S[H].stopPageInfo&&(S[H].stopPageInfo(),delete S[H].stopPageInfo);break;case"inPageLink":e=d(9),a=e.split("#")[1]||"",s=decodeURIComponent(a),(f=document.getElementById(s)||document.getElementsByName(s)[0])?(o=v(f),r(H,"Moving to in page link (#"+a+") at x: "+o.x+" y: "+o.y),N={x:o.x,y:o.y},F(),r(H,"--")):window.top!==window.self?window.parentIFrame?window.parentIFrame.moveToAnchor(a):r(H,"In page link #"+a+" not found and window.parentIFrame not found"):r(H,"In page link #"+a+" not found");break;case"reset":w(P);break;case"init":t(),I("initCallback",P.iframe);break;default:t()}var e,o,a,s,f,m}())):a(H,"Ignored: "+W)}function l(e,n,i){var t=null,o=null;if(S[e]){if("function"!=typeof(t=S[e][n]))throw new TypeError(n+" on iFrame["+e+"] is not a function");o=t(i)}return o}function u(e){var n=e.id;r(n,"Removing iFrame: "+n),e.parentNode&&e.parentNode.removeChild(e),l(n,"closedCallback",n),r(n,"--"),delete S[n]}function f(n){null===N&&r(n,"Get page position: "+(N={x:window.pageXOffset!==e?window.pageXOffset:document.documentElement.scrollLeft,y:window.pageYOffset!==e?window.pageYOffset:document.documentElement.scrollTop}).x+","+N.y)}function m(e){null!==N&&(window.scrollTo(N.x,N.y),r(e,"Set page position: "+N.x+","+N.y),g())}function g(){N=null}function w(e){r(e.id,"Size reset requested by "+("init"===e.type?"host page":"iFrame")),f(e.id),p(function(){h(e),b("reset","reset",e.iframe,e.id)},e,"reset")}function h(e){function n(n){C||"0"!==e[n]||(C=!0,r(t,"Hidden iFrame detected, creating visibility listener"),function(){function e(){function e(e){function n(n){return"0px"===(S[e]&&S[e].iframe.style[n])}S[e]&&null!==S[e].iframe.offsetParent&&(n("height")||n("width"))&&b("Visibility change","resize",S[e].iframe,e)}for(var n in S)e(n)}function n(n){r("window","Mutation observed: "+n[0].target+" "+n[0].type),k(e,16)}var i=window.MutationObserver||window.WebKitMutationObserver;i&&(t=document.querySelector("body"),new i(n).observe(t,{attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0}));var t}())}function i(i){var o;o=i,e.iframe.style[o]=e[o]+"px",r(e.id,"IFrame ("+t+") "+o+" set to "+e[o]+"px"),n(i)}var t=e.iframe.id;S[t]&&(S[t].sizeHeight&&i("height"),S[t].sizeWidth&&i("width"))}function p(e,n,i){i!==n.type&&W?(r(n.id,"Requesting animation frame"),W(e)):e()}function b(e,n,i,t,o){var a,d=!1;t=t||i.id,S[t]&&(i&&"contentWindow"in i&&null!==i.contentWindow?(a=S[t]&&S[t].targetOrigin,r(t,"["+e+"] Sending msg to iframe["+t+"] ("+n+") targetOrigin: "+a),i.contentWindow.postMessage(O+n,a)):s(t,"["+e+"] IFrame("+t+") not found"),o&&S[t]&&S[t].warningTimeout&&(S[t].msgTimeout=setTimeout(function(){!S[t]||S[t].loaded||d||(d=!0,s(t,"IFrame has not responded within "+S[t].warningTimeout/1e3+" seconds. Check iFrameResizer.contentWindow.js has been loaded in iFrame. This message can be ingored if everything is working, or you can set the warningTimeout option to a higher value or zero to suppress this warning."))},S[t].warningTimeout)))}function y(e){return e+":"+S[e].bodyMarginV1+":"+S[e].sizeWidth+":"+S[e].log+":"+S[e].interval+":"+S[e].enablePublicMethods+":"+S[e].autoResize+":"+S[e].bodyMargin+":"+S[e].heightCalculationMethod+":"+S[e].bodyBackground+":"+S[e].bodyPadding+":"+S[e].tolerance+":"+S[e].inPageLinks+":"+S[e].resizeFrom+":"+S[e].widthCalculationMethod}function v(i,t){var o,a,d,c,l,f=(o=i.id,o,""===o&&(i.id=(a=t&&t.id||A.id+z++,null!==document.getElementById(a)&&(a+=z++),o=a),R=(t||{}).log,o,r(o,"Added missing iframe ID: "+o+" ("+i.src+")")),o);f in S&&"iFrameResizer"in i?s(f,"Ignored iFrame, already setup."):(c=(c=t)||{},S[f]={firstRun:!0,iframe:i,remoteHost:i.src.split("/").slice(0,3).join("/")},function(e){if("object"!=typeof e)throw new TypeError("Options is not an object")}(c),function(e){for(var n in A)A.hasOwnProperty(n)&&(S[f][n]=e.hasOwnProperty(n)?e[n]:A[n])}(c),S[f]&&(S[f].targetOrigin=!0===S[f].checkOrigin?""===(l=S[f].remoteHost)||"file://"===l?"*":l:"*"),function(){switch(r(f,"IFrame scrolling "+(S[f]&&S[f].scrolling?"enabled":"disabled")+" for "+f),i.style.overflow=!1===(S[f]&&S[f].scrolling)?"hidden":"auto",S[f]&&S[f].scrolling){case!0:i.scrolling="yes";break;case!1:i.scrolling="no";break;default:i.scrolling=S[f]?S[f].scrolling:"no"}}(),function(){function e(e){1/0!==S[f][e]&&0!==S[f][e]&&(i.style[e]=S[f][e]+"px",r(f,"Set "+e+" = "+S[f][e]+"px"))}function n(e){if(S[f]["min"+e]>S[f]["max"+e])throw new Error("Value for min"+e+" can not be greater than max"+e)}n("Height"),n("Width"),e("maxHeight"),e("minHeight"),e("maxWidth"),e("minWidth")}(),("number"==typeof(S[f]&&S[f].bodyMargin)||"0"===(S[f]&&S[f].bodyMargin))&&(S[f].bodyMarginV1=S[f].bodyMargin,S[f].bodyMargin=S[f].bodyMargin+"px"),d=y(f),n(i,"load",function(){var n,t;b("iFrame.onload",d,i,e,!0),n=S[f]&&S[f].firstRun,t=S[f]&&S[f].heightCalculationMethod in P,!n&&t&&w({iframe:i,height:0,width:0,type:"init"})}),b("init",d,i,e,!0),Function.prototype.bind&&S[f]&&(S[f].iframe.iFrameResizer={close:u.bind(null,S[f].iframe),resize:b.bind(null,"Window resize","resize",S[f].iframe),moveToAnchor:function(e){b("Move to anchor","moveToAnchor:"+e,S[f].iframe,f)},sendMessage:function(e){b("Send Message","message:"+(e=JSON.stringify(e)),S[f].iframe,f)}}))}function k(e,n){null===H&&(H=setTimeout(function(){H=null,e()},n))}function F(e){r("window","Trigger event: "+e),k(function(){x("Window "+e,"resize")},16)}function I(){"hidden"!==document.visibilityState&&(r("document","Trigger event: Visiblity change"),k(function(){x("Tab Visable","resize")},16))}function x(e,n){for(var i in S)t=i,S[t]&&"parent"===S[t].resizeFrom&&S[t].autoResize&&!S[t].firstRun&&b(e,n,document.getElementById(i),i);var t}function M(){function i(e,n){n&&(function(){if(!n.tagName)throw new TypeError("Object is not a valid DOM element");if("IFRAME"!==n.tagName.toUpperCase())throw new TypeError("Expected <IFRAME> tag, found <"+n.tagName+">")}(),v(n,e),t.push(n))}var t;return function(){var e,n=["moz","webkit","o","ms"];for(e=0;e<n.length&&!W;e+=1)W=window[n[e]+"RequestAnimationFrame"];W||r("setup","RequestAnimationFrame not supported")}(),n(window,"message",c),n(window,"resize",function(){F("resize")}),n(document,"visibilitychange",I),n(document,"-webkit-visibilitychange",I),n(window,"focusin",function(){F("focus")}),n(window,"focus",function(){F("focus")}),function(n,o){switch(t=[],(r=n)&&r.enablePublicMethods&&s("enablePublicMethods option has been removed, public methods are now always available in the iFrame"),typeof o){case"undefined":case"string":Array.prototype.forEach.call(document.querySelectorAll(o||"iframe"),i.bind(e,n));break;case"object":i(n,o);break;default:throw new TypeError("Unexpected data type ("+typeof o+")")}var r;return t}}if("undefined"!=typeof window){var z=0,R=!1,C=!1,E="message".length,O="[iFrameSizer]",T=O.length,N=null,W=window.requestAnimationFrame,P={max:1,scroll:1,bodyScroll:1,documentElementScroll:1},S={},H=null,A={autoResize:!0,bodyBackground:null,bodyMargin:null,bodyMarginV1:8,bodyPadding:null,checkOrigin:!0,inPageLinks:!1,enablePublicMethods:!0,heightCalculationMethod:"bodyOffset",id:"iFrameResizer",interval:32,log:!1,maxHeight:1/0,maxWidth:1/0,minHeight:0,minWidth:0,resizeFrom:"parent",scrolling:!1,sizeHeight:!0,sizeWidth:!1,warningTimeout:5e3,tolerance:0,widthCalculationMethod:"scroll",closedCallback:function(){},initCallback:function(){},messageCallback:function(){s("MessageCallback function not defined")},resizedCallback:function(){},scrollCallback:function(){return!0}},j={};window.jQuery&&((q=window.jQuery).fn?q.fn.iFrameResize||(q.fn.iFrameResize=function(e){return this.filter("iframe").each(function(n,i){v(i,e)}).end()}):a("","Unable to bind to jQuery, it is not fully loaded.")),"function"==typeof define&&define.amd?define([],M):"object"==typeof module&&"object"==typeof module.exports?module.exports=M():window.iFrameResize=window.iFrameResize||M()}var q}();
